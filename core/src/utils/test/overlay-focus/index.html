<!DOCTYPE html>
<html dir="ltr">
  <head>
    <meta charset="UTF-8">
    <title>Overlay Utils - Focus</title>
    <meta name="viewport"
      content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link href="../../../../../css/ionic.bundle.css" rel="stylesheet">
    <link href="../../../../../scripts/testing/styles.css" rel="stylesheet">
    <script src="../../../../../scripts/testing/scripts.js"></script>
    <script nomodule src="../../../../../dist/ionic/ionic.js"></script>
    <script type="module" src="../../../../../dist/ionic/ionic.esm.js"></script>
    <script type="module">
      import { modalController, actionSheetController, alertController, pickerController, popoverController, toastController } from '../../../../dist/ionic/index.esm.js';

      window.modalController = modalController;
      window.actionSheetController = actionSheetController;
      window.popoverController = popoverController;
      window.alertController = alertController;
      window.pickerController = pickerController;
      window.toastController = toastController;
    </script>
  </head>

  <body>
    <ion-app>
      <ion-header>
        <ion-toolbar>
          <ion-title>Overlay Utils - Focus</ion-title>
        </ion-toolbar>
      </ion-header>

      <ion-content class="ion-padding">
        <ion-button expand="block" id="open-modal" onclick="openModal()">Open Modal</ion-button>
        <ion-button expand="block" id="open-input-modal" onclick="openModal('input')">Open Modal with Input</ion-button>
        <ion-button expand="block" id="open-button-modal" onclick="openModal('button')">Open Modal with Buttons</ion-button>

        <ion-button expand="block" id="open-action-sheet" onclick="openActionSheet()">Open Action Sheet</ion-button>

        <ion-button expand="block" id="open-popover" onclick="openPopover()">Open Popover</ion-button>

        <ion-button expand="block" id="open-alert" onclick="openAlert()">Open Alert</ion-button>

        <ion-button expand="block" id="open-picker" onclick="openPicker()">Open Picker</ion-button>

        <ion-button expand="block" id="open-toast" onclick="openToast()">Open Toast</ion-button>
      </ion-content>
    </ion-app>

    <script>
      customElements.define('modal-page', class extends HTMLElement {
        connectedCallback() {
          this.innerHTML = `
            <ion-header>
              <ion-toolbar>
                <ion-title>Modal</ion-title>
                <ion-buttons slot="end">
                  <ion-button id="close">Close</ion-button>
                </ion-buttons>
              </ion-toolbar>
            </ion-header>
            <ion-content class="ion-padding"></ion-content>
          `;

          const closeButton = document.querySelector('#close');
          closeButton.addEventListener('click', () => {
            modalController.dismiss();
          });
        }
      });
      customElements.define('popover-page', class extends HTMLElement {
        connectedCallback() {
          this.innerHTML = `
            <ion-content class="ion-padding">
              <ion-button id="close" expand="block">Close</ion-button>
            </ion-content>
          `;

          const closeButton = document.querySelector('#close');
          closeButton.addEventListener('click', () => {
            popoverController.dismiss();
          });
        }
      });

      const openModal = async (type) => {
        const modal = await modalController.create({
          component: 'modal-page'
        });

        requestAnimationFrame(() => {
          const modalContent = document.querySelector('modal-page ion-content');

          let innerHTML = '';
          switch (type) {
            case "input":
              innerHTML = `<ion-input placeholder="Text"></ion-input>`;
              break;
            case "button":
              innerHTML = `
                <ion-button color="danger">Destroy</ion-button>
                <ion-button>Cancel</ion-input>
              `;
              break;
            default:
              break;
          }
          modalContent.innerHTML = innerHTML;
        });

        return await modal.present();
      }
      const openActionSheet = async () => {
        const actionSheet = await actionSheetController.create({
          header: "Action Sheet",
          buttons: [
            { text: "Delete" },
            { text: "Cancel" }
          ]
        });

        return await actionSheet.present();
      }
      const openPopover = async () => {
        const popover = await popoverController.create({
          component: 'popover-page'
        });

        return await popover.present();
      }

      const openAlert = async () => {
        const alert = await alertController.create({
          header: 'Alert',
          message: 'This is an alert'
        });

        return await alert.present();
      }

      const openPicker = async () => {
        const picker = await pickerController.create({
          buttons: [
            { text: 'Destroy' },
            { text: 'Cancel' }
          ]
        });

        return await picker.present();
      }

      const openToast = async () => {
        const toast = await toastController.create({
          header: 'Toast',
          message: 'Input: <ion-input></ion-input>',
          duration: 5000
        });

        return await toast.present();
      }
    </script>
  </body>
</html>
